--if not exists (select name from sysobjects where name = 'AL_LapteSubventionat' and type = 'V') 
CREATE VIEW [AL_LapteSubventionat] AS
SELECT
LapteSubventionat.Nr_inregistrare AS LapteSubventionat_Nr_inregistrare,
LapteSubventionat.Data AS LapteSubventionat_Data,
LapteSubventionat.Producator AS LapteSubventionat_Producator,
LapteSubventionat.Data_inf_perioada AS LapteSubventionat_Data_inf_perioada,
LapteSubventionat.Data_sup_perioada AS LapteSubventionat_Data_sup_perioada,
LapteSubventionat.Data_lunii AS LapteSubventionat_Data_lunii,
LapteSubventionat.Tip AS LapteSubventionat_Tip,
LapteSubventionat.Centru_colectare AS LapteSubventionat_Centru_colectare,
LapteSubventionat.Den_centru_colectare AS LapteSubventionat_Den_centru_colectare,
LapteSubventionat.Tip_lapte AS Tip_lapte,
LapteSubventionat.Den_tip_lapte AS LapteSubventionat_Den_tip_lapte,
LapteSubventionat.Cant_UM AS LapteSubventionat_Cant_UM,
LapteSubventionat.Grasime AS LapteSubventionat_Grasime,
LapteSubventionat.Cant_UG AS LapteSubventionat_Cant_UG,
LapteSubventionat.Cant_STAS AS LapteSubventionat_Cant_STAS,
LapteSubventionat.Pret AS LapteSubventionat_Pret,
LapteSubventionat.Valoare AS LapteSubventionat_Valoare,
LapteSubventionat.Cant_UM_cota AS LapteSubventionat_Cant_UM_cota,
LapteSubventionat.Cant_UG_cota AS LapteSubventionat_Cant_UG_cota,
LapteSubventionat.Rezultat_analiza_lapte AS LapteSubventionat_Rezultat_analiza_lapte,
LapteSubventionat.Buletine_analiza AS LapteSubventionat_Buletine_analiza,
CalStd.Data AS CalStd_Data,
CalStd.Data_lunii AS CalStd_Data_lunii,
CalStd.An AS CalStd_An,
CalStd.Luna AS CalStd_Luna,
CalStd.LunaAlfa AS CalStd_LunaAlfa,
CalStd.Zi AS CalStd_Zi,
CalStd.Saptamana AS CalStd_Saptamana,
CalStd.Trimestru AS CalStd_Trimestru,
CalStd.Zi_alfa AS CalStd_Zi_alfa,
CalStd.Camp1 AS CalStd_Camp1,
CalStd.Camp2 AS CalStd_Camp2,
CalStd.Camp3 AS CalStd_Camp3,
CalStd.Fel_zi AS CalStd_Fel_zi,
AdevLapteSubventionat.Nr_inregistrare AS AdevLapteSubventionat_Nr_inregistrare,
AdevLapteSubventionat.Data AS AdevLapteSubventionat_Data,
AdevLapteSubventionat.Suma_cant_UM_cota_livrata AS AdevLapteSubventionat_Suma_cant_UM_cota_livrata,
AdevLapteSubventionat.Suma_cant_UM_cota_subventionata AS AdevLapteSubventionat_Suma_cant_UM_cota_subventionata,
AdevLapteSubventionat.Nr_luni_valide AS AdevLapteSubventionat_Nr_luni_valide,
AdevLapteSubventionat.Buletine_analiza AS AdevLapteSubventionat_Buletine_analiza,
AdevSubvenLapte.Nr_inregistrare AS AdevSubvenLapte_Nr_inregistrare,
AdevSubvenLapte.Data AS AdevSubvenLapte_Data,
AdevSubvenLapte.Producator AS AdevSubvenLapte_Producator,
AdevSubvenLapte.Data_inf_perioada AS AdevSubvenLapte_Data_inf_perioada,
AdevSubvenLapte.Data_sup_perioada AS AdevSubvenLapte_Data_sup_perioada,
AdevSubvenLapte.Rezultat_trimestru AS AdevSubvenLapte_Rezultat_trimestru,
AdevSubvenLapte.Cantitate_livrata AS AdevSubvenLapte_Cantitate_livrata,
AdevSubvenLapte.Cantitate_subventionata AS AdevSubvenLapte_Cantitate_subventionata,
AdevSubvenLapte.Data_operarii AS AdevSubvenLapte_Data_operarii,
AdevSubvenLapte.Ora_operarii AS AdevSubvenLapte_Ora_operarii,
AdevSubvenLapte.Utilizator AS AdevSubvenLapte_Utilizator,
ProdLapte.Cod_producator AS ProdLapte_Cod_producator,
ProdLapte.Denumire AS ProdLapte_Denumire,
ProdLapte.Initiala_tatalui AS ProdLapte_Initiala_tatalui,
ProdLapte.Serie_buletin AS ProdLapte_Serie_buletin,
ProdLapte.Nr_buletin AS ProdLapte_Nr_buletin,
ProdLapte.Eliberat AS ProdLapte_Eliberat,
ProdLapte.CNP_CUI AS ProdLapte_CNP_CUI,
ProdLapte.Judet AS ProdLapte_Judet,
ProdLapte.Localitate AS ProdLapte_Localitate,
ProdLapte.Comuna AS ProdLapte_Comuna,
ProdLapte.Sat AS ProdLapte_Sat,
ProdLapte.Strada AS ProdLapte_Strada,
ProdLapte.Nr_str AS ProdLapte_Nr_str,
ProdLapte.Nr_casa AS ProdLapte_Nr_casa,
ProdLapte.Bloc AS ProdLapte_Bloc,
ProdLapte.Scara AS ProdLapte_Scara,
ProdLapte.Etaj AS ProdLapte_Etaj,
ProdLapte.Ap AS ProdLapte_Ap,
ProdLapte.Cod_exploatatie AS ProdLapte_Cod_exploatatie,
ProdLapte.Cota_actuala AS ProdLapte_Cota_actuala,
ProdLapte.Grad_actual AS ProdLapte_Grad_actual,
ProdLapte.Vaci AS ProdLapte_Vaci,
ProdLapte.Tip_pers AS ProdLapte_Tip_pers,
ProdLapte.Tert AS ProdLapte_Tert,
ProdLapte.Reprezentant AS ProdLapte_Reprezentant,
ProdLapte.CNP_repr AS ProdLapte_CNP_repr,
ProdLapte.Centru_colectare AS ProdLapte_Centru_colectare,
ProdLapte.Loc_de_munca AS ProdLapte_Loc_de_munca,
ProdLapte.Data_operarii AS ProdLapte_Data_operarii,
ProdLapte.Ora_operarii AS ProdLapte_Ora_operarii,
ProdLapte.Utilizator AS ProdLapte_Utilizator,
CentrColectLapte.Cod_centru_colectare AS CentrColectLapte_Cod_centru_colectare,
CentrColectLapte.Denumire AS CentrColectLapte_Denumire,
CentrColectLapte.Cod_IBAN AS CentrColectLapte_Cod_IBAN,
CentrColectLapte.Banca AS CentrColectLapte_Banca,
CentrColectLapte.Sat AS CentrColectLapte_Sat,
CentrColectLapte.Comuna AS CentrColectLapte_Comuna,
CentrColectLapte.Localitate AS CentrColectLapte_Localitate,
CentrColectLapte.Judet AS CentrColectLapte_Judet,
CentrColectLapte.Responsabil AS CentrColectLapte_Responsabil,
CentrColectLapte.Loc_de_munca AS CentrColectLapte_Loc_de_munca,
CentrColectLapte.Tip_pers AS CentrColectLapte_Tip_pers,
CentrColectLapte.Tert AS CentrColectLapte_Tert,
CentrColectLapte.Data_operarii AS CentrColectLapte_Data_operarii,
CentrColectLapte.Ora_operarii AS CentrColectLapte_Ora_operarii,
CentrColectLapte.Utilizator AS CentrColectLapte_Utilizator
FROM LapteSubventionat 
	LEFT JOIN CalStd ON CalStd.Data= LapteSubventionat.Data
	LEFT JOIN AdevLapteSubventionat ON AdevLapteSubventionat.Nr_inregistrare= LapteSubventionat.Nr_inregistrare
		AND AdevLapteSubventionat.Data= LapteSubventionat.Data
	LEFT JOIN AdevSubvenLapte ON AdevSubvenLapte.Nr_inregistrare= LapteSubventionat.Nr_inregistrare
		AND AdevSubvenLapte.Data= LapteSubventionat.Data
	LEFT JOIN ProdLapte ON ProdLapte.Cod_producator= LapteSubventionat.Producator
	LEFT JOIN CentrColectLapte ON CentrColectLapte.cod_centru_colectare= LapteSubventionat.Centru_colectare